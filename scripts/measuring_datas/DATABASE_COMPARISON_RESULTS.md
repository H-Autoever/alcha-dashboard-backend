# MongoDB vs TimescaleDB 실제 성능 검증 결과

## 📋 테스트 개요

실제 데이터 기반 측정값만 표시. 포장 없음.

- **테스트 데이터**: 10,000개 레코드 (쓰기 테스트), 실제 텔레메트리 데이터 10,800개 (읽기 테스트)
- **측정 방법**: 각 테스트 10회 반복 후 평균값 사용
- **환경**: Docker 컨테이너 (동일 환경)

---

## 📝 테스트 1: 쓰기 성능 검증

### MongoDB 쓰기 성능

| 배치 크기 | 총 레코드 | 총 시간 | 초당 처리 | 배치당 평균 |
|----------|----------|---------|----------|------------|
| 100 | 10,000개 | 131.56ms | 76,012 레코드/초 | 1.32ms |
| 1,000 | 10,000개 | 78.55ms | 127,314 레코드/초 | 7.85ms |
| 5,000 | 10,000개 | 72.54ms | 137,851 레코드/초 | 36.27ms |
| **10,000** | **10,000개** | **59.35ms** | **168,501 레코드/초** | **59.35ms** |

**최적 성능**: 배치 크기 10,000, 초당 처리 168,501 레코드/초

### TimescaleDB 쓰기 성능

| 배치 크기 | 총 레코드 | 총 시간 | 초당 처리 | 배치당 평균 |
|----------|----------|---------|----------|------------|
| 100 | 10,000개 | 1,920.47ms | 5,207 레코드/초 | 19.20ms |
| 1,000 | 10,000개 | 1,774.77ms | 5,635 레코드/초 | 177.48ms |
| 5,000 | 10,000개 | 1,761.20ms | 5,678 레코드/초 | 880.60ms |
| **10,000** | **10,000개** | **1,748.72ms** | **5,718 레코드/초** | **1,748.72ms** |

**최적 성능**: 배치 크기 10,000, 초당 처리 5,718 레코드/초

### 쓰기 성능 비교

| 항목 | MongoDB | TimescaleDB | 차이 |
|-----|---------|-------------|------|
| 초당 처리 (최적) | 168,501 레코드/초 | 5,718 레코드/초 | **MongoDB가 약 29배 빠름 (2,846.6% 빠름)** |

**결론**: MongoDB의 쓰기 성능이 TimescaleDB보다 현저히 빠릅니다.

---

## 📊 테스트 2: 시계열 데이터 읽기 성능 검증

### TimescaleDB 시계열 쿼리 성능

| 쿼리 타입 | 평균 시간 | 최소 시간 | 최대 시간 | 결과 개수 |
|----------|----------|----------|----------|----------|
| 시간 범위 쿼리 (1시간 데이터) | 4.32ms | 3.54ms | 9.03ms | 3,600개 |
| 집계 쿼리 (평균/최대/최소) | 0.89ms | 0.71ms | 2.17ms | 1개 |
| 시간 기반 그룹화 (10분 단위) | 0.92ms | 0.83ms | 1.27ms | 7개 |
| 시간 기반 그룹화 (1분 단위) | 0.94ms | 0.88ms | 1.14ms | 61개 |
| 복잡한 시간 범위 집계 (다중 차량) | 2.42ms | 2.29ms | 2.73ms | 39개 |

### MongoDB 시계열 쿼리 성능

| 쿼리 타입 | 평균 시간 | 최소 시간 | 최대 시간 | 결과 개수 |
|----------|----------|----------|----------|----------|
| 시간 범위 쿼리 (1시간 데이터) | 20.44ms | 17.46ms | 30.32ms | 3,600개 |
| 집계 쿼리 (평균/최대/최소) | 5.59ms | 5.03ms | 8.65ms | 1개 |
| 시간 기반 그룹화 (10분 단위) | 25.81ms | 25.01ms | 28.33ms | 7개 |

### 읽기 성능 비교 (동일한 쿼리)

| 쿼리 타입 | MongoDB | TimescaleDB | 차이 |
|----------|---------|-------------|------|
| 시간 범위 쿼리 | 20.44ms | 4.32ms | **TimescaleDB가 약 4.7배 빠름 (372.7% 빠름)** |
| 집계 쿼리 | 5.59ms | 0.89ms | **TimescaleDB가 약 6.3배 빠름 (530.4% 빠름)** |
| 시간 기반 그룹화 (10분) | 25.81ms | 0.92ms | **TimescaleDB가 약 28배 빠름 (2,698.2% 빠름)** |

**결론**: TimescaleDB의 시계열 쿼리 성능이 MongoDB보다 현저히 빠릅니다. 특히 시간 기반 그룹화에서 큰 차이를 보입니다.

---

## 📈 종합 비교 요약

### 1. 쓰기 성능

| 데이터베이스 | 초당 처리 (최적 배치) | 결론 |
|------------|---------------------|------|
| **MongoDB** | 168,501 레코드/초 | ⭐ **쓰기에 최적화** |
| **TimescaleDB** | 5,718 레코드/초 | 쓰기 성능은 상대적으로 낮음 |

**MongoDB가 약 29배 빠름**

### 2. 시계열 읽기 성능

| 쿼리 타입 | MongoDB | TimescaleDB | 결론 |
|----------|---------|-------------|------|
| 시간 범위 쿼리 | 20.44ms | 4.32ms | ⭐ **TimescaleDB 우수** |
| 집계 쿼리 | 5.59ms | 0.89ms | ⭐ **TimescaleDB 우수** |
| 시간 기반 그룹화 | 25.81ms | 0.92ms | ⭐ **TimescaleDB 매우 우수 (약 28배 빠름)** |

**TimescaleDB가 평균 약 4-28배 빠름**

---

## 🎯 실제 사용 사례별 권장사항

### MongoDB를 사용해야 하는 경우

**검증된 사실**:
- ✅ **쓰기 성능**: 초당 168,501 레코드 처리 (TimescaleDB 대비 약 29배 빠름)
- ✅ **유연한 스키마**: 복잡한 중첩 구조 데이터 저장 가능
- ✅ **빠른 데이터 수집**: 실시간 데이터 수집 단계에 최적

**사용 시나리오**:
- 초기 데이터 수집 (높은 쓰기 처리량 필요)
- 다양한 형태의 이벤트 데이터 저장
- 스키마 정의 없이 빠른 프로토타이핑

### TimescaleDB를 사용해야 하는 경우

**검증된 사실**:
- ✅ **시계열 읽기 성능**: MongoDB 대비 평균 4-28배 빠름
- ✅ **시간 기반 그룹화**: MongoDB 대비 약 28배 빠름
- ✅ **집계 쿼리**: MongoDB 대비 약 6배 빠름

**사용 시나리오**:
- 시계열 데이터 분석 및 조회
- 대시보드 쿼리 (실시간 통계)
- 시간 기반 집계 및 그룹화
- 복잡한 SQL 기반 분석

---

## 🏗️ 하이브리드 아키텍처의 타당성

### 검증된 성능 차이

1. **MongoDB**: 쓰기 성능 우수 (초당 168,501 레코드)
   - 초기 데이터 수집 단계에 적합
   - 빠른 쓰기 처리량 필요 시 사용

2. **TimescaleDB**: 시계열 읽기 성능 우수 (평균 4-28배 빠름)
   - 시계열 데이터 분석 및 조회에 적합
   - 시간 기반 집계 및 그룹화 최적화

### 결론

**각 데이터베이스의 강점**:
- MongoDB: **쓰기 성능** (약 29배 빠름)
- TimescaleDB: **시계열 읽기 성능** (평균 4-28배 빠름)

**하이브리드 아키텍처의 타당성**:
- ✅ 데이터 수집 단계: MongoDB 사용 (빠른 쓰기)
- ✅ 데이터 분석 단계: TimescaleDB 사용 (빠른 시계열 쿼리)
- ✅ 각 단계에서 가장 적합한 데이터베이스 사용으로 전체 성능 최적화

---

## 📝 참고사항

- 모든 측정값은 실제 데이터 기반
- 각 테스트는 10회 반복 후 평균값 사용
- 동일한 환경에서 측정 (Docker 컨테이너)
- 실제 성능은 데이터 크기, 인덱스, 하드웨어에 따라 달라질 수 있음
